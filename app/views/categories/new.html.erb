<!-- add and edit chemicals -->
<!-- only add chemicals to an item -->
<script>

// var edit = "<input type='file' name='chemical[image]' accept='image/*'><br>";



	$(document).ready(function(){
		$("#addNewChemical").click(function(){
			console.log("we are hovering");
			$("#adding_a_new_chemical").html(addNewChemical);
		});
		$('img').click(function(){
			console.log("clicked the image");
			$('#chemical_image_upload').append(edit);
		})
		$('#confirm_chemical').click(function(){
			console.log("confirmed!");
			$("#categorize").html(addCategories);
		});
		$('#select_a_category').submit(function(e){
			e.preventDefault();
			$.post(
				$(this).attr('action'),
				$(this).serialize(),
				function(data){
					console.log(data);
				for (i=0; i<data.subcategories.length; i++)
				{
					var id = data.subcategories[i].id
					var subcategory = "<input type='checkbox' name='subcat[]' value="+id+">"+data.subcategories[i].name+"</input><br>";
					if (i==0){
						$('.appendedsubcat').html(subcategory);
					}
					else{
					$('.appendedsubcat').append(subcategory);
					}
				}
				}, 
				'json');
			return false;
			});
		$("#percent").keyup(function(e){
			if(e.keyCode !=8){
				if($(this).val().length==2){
					$(this).val($(this).val()+".");
				}
			}
		});

		});

</script>


<div id="itemcontainer">
<div id="sidebar">
	<h3>Welcome, <%= @admin.username %>, you lovely person!</h3>
	<h5>Here are some useful links:</h5>
	<a href="#">Add Item</a><br>
	<a href="#">Edit Item</a><br>
	<a href="#">Add Chemicals</a><br>
	<a href="#">Categories</a><br>
	<a href="#">Literacies</a><br>
	<a href="#">GMOs</a><br>

</div>
	<div id="items">
		<FIELDSET>
		<% if flash[:errors] %>
		<% flash[:errors].each do |e| %>
		<%= e %>
		<% end %>
		<% end %>

		<% if flash[:success] %>
		<% flash[:success].each do |s| %>
		<%= s %>
		<% end %>
		<% end %>

		<% if session[:item_id] %>
		<div id="items">
				<h3>Current Item: <%=@currentItem.name%><a href="/items/new"></h3><button>Edit <%=@currentItem.name%></button></a></h3>
		</div>
		<% end %>

		<!-- edit chemical -->

<!-- this part renders all added chemicals for this particular item -->
	<div id="added_chemicals">
		<%if @addedChemicals %>
		<h3> Added Chemicals </h3>
		<% @addedChemicals.each do |added| %>
			<div class="added"><%= added.name %></div>
		<% end %>
		<% end %>
	</div>
	<!-- this renders current chemical -->
<!-- renders option to categorize the chemical -->
	<div id="categorize_chemical">
		<h3>Add a Category & Subcategory to <%= @currentChemical.name %></h3>
		<table>
			<thead>
				<th>Category</th>
				<th>Subcategory</th>
				<th>Percentage</th>
				<th>Action</th>
			</thead>
			<tbody>
				<tr>
					<td>
						<form id ='select_a_category' action='/categories/selectCat' method='post'>
							<input name='authenticity_token' value='<%= form_authenticity_token %>' type='hidden'>
							<select name='category' id='cat'><% @categories.each do |category| %>
								<option value='<%=category.id%>:<%=session[:chemical_id]%>'><%=category.name%></option>
							<% end %></select><br>
							<button>Add Category</button>
						</form>
					</td>
					<td>
						<form action='/categories' method='post'>
						<input name='authenticity_token' value='<%= form_authenticity_token %>' type='hidden'>
						<div class="appendedsubcat"></div>
					</td>
					<td>
						<input type="text" id="percent" name="percentage">%
					</td>
					<td>
						<button>Categorize</button></form>
					</td>
				</tr>
			</tbody>
		</table>
	</div>

		</FIELDSET>
	</div>
</div>
